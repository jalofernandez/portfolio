"use strict";!function(t){function e(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function i(t,e){return Math.floor(Math.random()*(e-t+1))+t}function n(t,i){this.el=t,this.options=e({},this.options),e(this.options,i),this._init()}function o(t,i){this.elems=[].slice.call(t),this.options=e({},this.options),e(this.options,i),this.glitch()}n.prototype.options={pieces:{rows:14,columns:10},tilt:{maxRotationX:-2,maxRotationY:3,maxTranslationX:6,maxTranslationY:-2}},n.prototype._init=function(){this.imgsrc=this.el.style.backgroundImage.replace("url(","").replace(")","").replace(/\"/gi,""),this.win={width:t.innerWidth,height:t.innerHeight},this.dimensions={width:this.el.offsetWidth,height:this.el.offsetHeight},this._layout(),this.initTilt(),this._initEvents()},n.prototype._layout=function(){this.el.style.backgroundImage=this.el.getAttribute("data-img-code"),this.pieces=[];for(var t=0;t<this.options.pieces.rows;++t)for(var e=0;e<this.options.pieces.columns;++e){var i=this._createPiece(t,e);i.style.backgroundPosition=-1*e*100+"% "+-100*t+"%",this.pieces.push(i)}},n.prototype._createPiece=function(t,e){var i=Math.round(this.dimensions.width/this.options.pieces.columns),n=Math.round(this.dimensions.height/this.options.pieces.rows),o=document.createElement("div");return o.style.backgroundImage="url("+this.imgsrc+")",o.className="piece",o.style.width=i+"px",o.style.height=n+NaN,o.style.backgroundSize=i*this.options.pieces.columns+"px auto",o.setAttribute("data-column",e),o.setAttribute("data-delay",anime.random(-25,25)),this.el.appendChild(o),this.el.style.width=i*this.options.pieces.columns+"px",this.el.style.height=n*this.options.pieces.rows+"px",o},n.prototype.initTilt=function(){a||(this.el.style.transition="transform 0.2s ease-out",this.tilt=!0)},n.prototype.removeTilt=function(){a||(this.tilt=!1)},n.prototype._initEvents=function(){var e,i,n,o,s=this,r=(e=function(){s.win={width:t.innerWidth,height:t.innerHeight},s.el.style.width=s.el.style.height="";var e=s.el.getBoundingClientRect();s.dimensions={width:e.width,height:e.height};for(var i=0,n=s.pieces.length;i<n;++i){var o=Math.round(s.dimensions.width/s.options.pieces.columns),a=Math.round(s.dimensions.height/s.options.pieces.rows),r=s.pieces[i];r.style.width=o+"px",r.style.height=a+"px",r.style.backgroundSize=o*s.options.pieces.columns+"px auto",s.el.style.width=o*s.options.pieces.columns+"px",s.el.style.height=a*s.options.pieces.rows+"px"}},i=10,function(){var t=this,s=arguments,a=n&&!o;clearTimeout(o),o=setTimeout(function(){o=null,n||e.apply(t,s)},i),a&&e.apply(t,s)});document.addEventListener("mousemove",function(e){requestAnimationFrame(function(){if(!s.tilt)return a&&(s.el.style.transform="none"),!1;var i,n,o,r=(n=0,o=0,(i=e)||(i=t.event),i.pageX||i.pageY?(n=i.pageX,o=i.pageY):(i.clientX||i.clientY)&&(n=i.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,o=i.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:n,y:o}),l=2*s.options.tilt.maxRotationX/s.win.height*r.y-s.options.tilt.maxRotationX,c=2*s.options.tilt.maxRotationY/s.win.width*r.x-s.options.tilt.maxRotationY,u=2*s.options.tilt.maxTranslationX/s.win.width*r.x-s.options.tilt.maxTranslationX,d=2*s.options.tilt.maxTranslationY/s.win.height*r.y-s.options.tilt.maxTranslationY;s.el.style.transform="perspective(1000px) translate3d("+u+"px,"+d+"px,0) rotate3d(1,0,0,"+l+"deg) rotate3d(0,1,0,"+c+"deg)"})}),t.addEventListener("resize",r)},n.prototype.loopFx=function(){this.isLoopFXActive=!0,this.el.style.backgroundImage=this.el.getAttribute("data-img-alt");var t=this;anime.remove(this.pieces),anime({targets:this.pieces,duration:50,easing:"linear",opacity:[{value:function(t,e){return anime.random(0,5)?1:0},delay:function(t,e){return anime.random(0,2e3)}},{value:1,delay:function(t,e){return anime.random(200,2e3)}}],complete:function(){t.isLoopFXActive&&t.loopFx()}})},n.prototype.stopLoopFx=function(){this.isLoopFXActive=!1,this.el.style.backgroundImage=this.el.getAttribute("data-img-code"),anime.remove(this.pieces);for(var t=0,e=this.pieces.length;t<e;++t)this.pieces[t].style.opacity=1},n.prototype.animatePieces=function(t,e){var i=this;anime.remove(this.pieces),anime({targets:this.pieces.reverse(),duration:"out"===t?600:500,delay:function(t,e){return Math.max(0,6*e+parseInt(t.getAttribute("data-delay")))},easing:"out"===t?[.2,1,.3,1]:[.8,1,.3,1],translateX:"out"===t?function(t,e){return t.getAttribute("data-column")<i.options.pieces.columns/2?anime.random(50,100):anime.random(-100,-50)}:function(t,e){return t.getAttribute("data-column")<i.options.pieces.columns/2?[anime.random(50,100),0]:[anime.random(-100,-50),0]},translateY:"out"===t?function(t,e){return[0,anime.random(-1e3,-800)]}:function(t,e){return[anime.random(-1e3,-800),0]},opacity:{value:"out"===t?0:1,duration:"out"===t?600:300,easing:"linear"},complete:e})},n.prototype.fxCustom=function(t){this.fxCustomTriggered=!0;var e=this;anime({targets:this.pieces.reverse().filter(function(t){return t.getAttribute("data-column")<e.options.pieces.columns/2}),duration:"left"===t?400:200,easing:"left"===t?[.2,1,.3,1]:[.8,0,.7,0],delay:function(e,i,n){return"left"===t?Math.max(0,5*i+parseInt(e.getAttribute("data-delay"))):Math.max(0,2*(n-1-i)+parseInt(e.getAttribute("data-delay")))},translateX:function(e,i){return"left"===t?anime.random(-500,-100):[anime.random(-500,-100),0]},translateY:function(e,i){return"left"===t?anime.random(0,100):[anime.random(0,100),0]},opacity:{duration:200,value:"left"===t?0:[0,1],easing:"left"===t?"linear":[.8,0,.7,0]}})},n.prototype.fxCustomReset=function(t,e){this.fxCustomTriggered=!1;var i=this;anime.remove(this.pieces),anime({targets:this.pieces.reverse().filter(function(t){return t.getAttribute("data-column")<i.options.pieces.columns/2}),duration:"left"===t?200:400,easing:"left"===t?[.8,0,.7,0]:[.2,1,.3,1],delay:function(e,i,n){return"left"===t?Math.max(0,2*(n-1-i)+parseInt(e.getAttribute("data-delay"))):Math.max(0,5*i+parseInt(e.getAttribute("data-delay")))},translateX:function(e,i){return"left"===t?0:anime.random(-500,-100)},translateY:function(e,i){return"left"===t?0:anime.random(0,100)},opacity:{duration:200,value:"left"===t?1:[1,0],easing:"left"===t?[.8,0,.7,0]:"linear"},complete:e})},t.PieceMaker=n,o.prototype.options={glitchStart:{min:500,max:4e3},glitchState:{min:50,max:250},glitchTotalIterations:6},o.prototype.glitch=function(){this.isInactive=!1;var t=this;clearTimeout(this.glitchTimeout),this.glitchTimeout=setTimeout(function(){t.iteration=0,t._glitchState(function(){t.isInactive||t.glitch()})},i(this.options.glitchStart.min,this.options.glitchStart.max))},o.prototype._glitchState=function(t){var e=this;this.iteration<this.options.glitchTotalIterations?this.glitchStateTimeout=setTimeout(function(){e.elems.forEach(function(t){t.classList.contains("mode--code")?(t.classList.add("mode--design"),t.classList.remove("mode--code")):(t.classList.add("mode--code"),t.classList.remove("mode--design")),t.style.transform=e.iteration%2!=0?"translate3d(0,0,0)":"translate3d("+i(-5,5)+"px,"+i(-5,5)+"px,0)"}),e.iteration++,e.isInactive||e._glitchState(t)},i(this.options.glitchState.min,this.options.glitchState.max)):t.call()},o.prototype.stopGlitch=function(){this.isInactive=!0,clearTimeout(this.glitchTimeout),clearTimeout(this.glitchStateTimeout),this.elems.forEach(function(t){t.classList.contains("mode--code")&&(t.classList.add("mode--design"),t.classList.remove("mode--code"),t.style.transform="translate3d(0,0,0)")})},t.GlitchFx=o;var s={},a=navigator.userAgent.indexOf("Firefox")>0,r=void 0,l=void 0;s.body=document.body,s.loading=document.querySelector(".loading"),s.switchCtrls=document.querySelector(".switch"),s.switchModeCtrls={design:s.switchCtrls.firstElementChild,code:s.switchCtrls.lastElementChild},s.pieces=document.querySelector(".pieces"),s.glitchElems=document.querySelectorAll("[data-glitch]"),s.contact={el:document.querySelector(".contact-link")},s.title={el:document.querySelector(".title > .title__inner")},s.menuCtrl=document.querySelector(".btn--menu"),s.menu={design:{wrapper:document.querySelector(".menu"),items:document.querySelector(".menu").firstElementChild.querySelectorAll(".menu__inner a")},code:{wrapper:document.querySelector(".menu--code"),items:document.querySelectorAll(".menu--code > .menu__inner a")}},s.overlay=document.querySelector(".overlay");var c="design",u=void 0,d=void 0;function m(t){if(t.preventDefault(),d)return!1;var e,i,n;d=!0,c=t.target===s.switchModeCtrls.code?"code":"design",anime.remove(s.overlay),anime({targets:s.overlay,duration:800,easing:"linear",opacity:"code"===c?1:0}),"code"===c&&(u=!0,r.removeTilt(),r.stopLoopFx(),l.stopGlitch()),s.switchModeCtrls["code"===c?"design":"code"].classList.remove("switch__item--current"),s.switchModeCtrls[c].classList.add("switch__item--current"),s.switchCtrls.classList.remove("mode--"+("code"===c?"design":"code")),s.switchCtrls.classList.add("mode--"+c),"code"===c?(n=function(t){var e=s[t].el||s[t];"title"!==t&&"contact"!==t&&"menuCtrl"!==t||(e.classList.remove("mode--design"),e.classList.add("mode--code")),s[t].letters?p(s[t].letters,"in",{begin:function(){s[t].el.style.opacity=1,s[t].el.style.transform="none"}}):(e.style.opacity=1,e.style.transform="none")},(i=function(t,e){var i={};"string"==typeof t?(i.targets=s[t].el||s[t],i.duration=400,i.easing="easeInQuint",i.scale=.3):(i.targets=t,i.duration=100,i.delay=function(t,e){return 100*e},i.easing="easeInQuad",i.translateY="-75%"),i.opacity={value:0,easing:"linear"},i.complete=e,anime.remove(i.targets),anime(i)})("title",function(){n("title")}),i("contact",function(){n("contact")}),i("menuCtrl",function(){n("menuCtrl")}),i(s.menu.design.items,function(){s.menu.design.wrapper.style.display="none",p(s.menuCodeItemLetters,"in",{delay:function(t,e){return 30*e},begin:function(){s.menu.code.wrapper.style.display="block"}})})):(e=function(t){var e={};if("string"==typeof t){var i=s[t].el||s[t];i.classList.remove("mode--code"),i.classList.add("mode--design"),e.targets=i,e.duration=400,e.easing="easeOutQuint",e.scale=[.3,1],e.begin=function(){void 0!==s[t].letters&&s[t].letters.forEach(function(t){t.style.opacity=1})}}else e.targets=t,e.duration=600,e.delay=function(t,e,i){return 100*(i-e-1)},e.easing="easeOutExpo",e.translateY=["-75%","0%"];e.opacity={value:[0,1],easing:"linear"},anime.remove(e.targets),anime(e)},p(s.title.letters,"out",{complete:function(){e("title")}}),p(s.contact.letters,"out",{complete:function(){e("contact")}}),s.menuCtrl.style.opacity=0,e("menuCtrl"),p(s.menuCodeItemLetters,"out",{delay:function(t,e,i){return 10*(i-e-1)},duration:20,complete:function(){s.menu.code.wrapper.style.display="none",s.menu.design.wrapper.style.display="block",e(s.menu.design.items)}})),r.animatePieces("code"===c?"out":"in",function(){d=!1,"design"===c&&(r.initTilt(),r.loopFx(),l.glitch(),u=!1)})}function p(t,i,n){var o={};o.targets=t,o.duration=50,o.delay=function(t,e,n){return"in"===i?50*e:50*(n-e-1)},o.easing="in"===i?"easeInQuint":"easeOutQuint",o.opacity="in"===i?[0,1]:[1,0],e(o,n),anime.remove(o.targets),anime(o)}imagesLoaded(s.body,{background:!0},function(){s.loading.classList.add("loading--hide"),(r=new n(s.pieces)).loopFx(),l=new o(s.glitchElems),charming(s.title.el),s.title.letters=[].slice.call(s.title.el.querySelectorAll("span")),charming(s.contact.el),s.contact.letters=[].slice.call(s.contact.el.querySelectorAll("span")),s.menuCodeItemLetters=[],[].slice.call(s.menu.code.items).forEach(function(t){charming(t),s.menuCodeItemLetters.push([].slice.call(t.querySelectorAll("span")))}),function(){s.switchModeCtrls.design.addEventListener("click",m),s.switchModeCtrls.code.addEventListener("click",m);var t=function(){r.stopLoopFx(),l.stopGlitch(),r.removeTilt()},e=function(){r.loopFx(),l.isInactive&&l.glitch(),r.initTilt()};s.contact.el.addEventListener("mouseenter",function(e){if(d)return!1;"design"===c&&t(),r.fxCustom("design"===c?"left":"right")}),s.contact.el.addEventListener("mouseleave",function(t){if(d||!r.fxCustomTriggered)return!1;r.fxCustomReset("design"===c?"left":"right",function(){u||e()})}),s.switchCtrls.addEventListener("mouseenter",function(e){u||d||t()}),s.switchCtrls.addEventListener("mouseleave",function(t){u||d||e()})}()})}(window);